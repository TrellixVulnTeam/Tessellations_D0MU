import { isFunction } from '@thi.ng/checks/is-function';
import { last } from '@thi.ng/transducers/last';
import { mapcat } from '@thi.ng/transducers/mapcat';
import { push } from '@thi.ng/transducers/push';
import { reducer } from '@thi.ng/transducers/reduce';
import { repeat } from '@thi.ng/transducers/repeat';
import { scan } from '@thi.ng/transducers/scan';
import { transduce } from '@thi.ng/transducers/transduce';

function tessellate(...args) {
    return transduce(scan(reducer(() => [args[0]], (acc, fn) => transduce(mapcat(fn), push(), acc))), last(), isFunction(args[1]) ? repeat(args[1], args[2] || 1) : args[1]);
}

export { tessellate };
