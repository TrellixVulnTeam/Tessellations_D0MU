import { isPlainObject } from '@thi.ng/checks/is-plain-object';
import { DEFAULT_SAMPLES } from '@thi.ng/geom-api/sample';
import { copyVectors } from '@thi.ng/vectors/copy';
import { Sampler } from './sampler.js';
import '@thi.ng/geom-closest-point/line';
import '@thi.ng/math/fit';
import '@thi.ng/vectors/dist';
import '@thi.ng/vectors/distsq';
import '@thi.ng/vectors/eqdelta';
import '@thi.ng/vectors/mixn';
import '@thi.ng/vectors/normalize';
import '@thi.ng/vectors/set';
import '@thi.ng/vectors/sub';

const resample = (pts, opts, closed = false, copy = false) => {
    if (opts !== undefined) {
        const sampler = new Sampler(pts, closed);
        return isPlainObject(opts)
            ? closed
                ? opts.dist
                    ? sampler.sampleUniform(opts.dist, opts.last)
                    : sampler.sampleFixedNum(opts.num || DEFAULT_SAMPLES, opts.last)
                : opts.dist
                    ? sampler.sampleUniform(opts.dist, opts.last !== false)
                    : sampler.sampleFixedNum(opts.num || DEFAULT_SAMPLES, opts.last !== false)
            : sampler.sampleFixedNum(opts || DEFAULT_SAMPLES, !closed);
    }
    return copy ? copyVectors(pts) : pts;
};

export { resample };
